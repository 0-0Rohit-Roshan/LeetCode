Time: $O(n^2d)$  
Space: $O(nd)$